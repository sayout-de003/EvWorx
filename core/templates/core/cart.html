{% extends 'core/base.html' %}
{% block title %}Your Cart{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6">Your Shopping Cart</h1>

{% if cart_items %}
    <div class="grid gap-6">
        {% for item in cart_items %}
            <div class="bg-white rounded-xl shadow-md p-4 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    {% if item.product.image %}
                        <img src="{{ item.product.image.url }}" alt="{{ item.product.title }}" class="w-20 h-20 object-cover rounded-md border">
                    {% endif %}
                    <div>
                        <h2 class="text-lg font-semibold">
                            {{ item.product.title }}
                        </h2>
                        <p class="text-gray-500">Price: ₹{{ item.product.price }}</p>
                        <p class="text-gray-600">Subtotal: ₹{{ item.subtotal }}</p>
                    </div>
                </div>

                <div class="flex items-center gap-4">
                    <form method="POST" action="{% url 'cart' %}" class="flex items-center gap-2">
                        {% csrf_token %}
                        <input type="hidden" name="update" value="1">
                        <input type="hidden" name="product_id" value="{{ item.product.id }}">
                        <input type="number" name="quantity" value="{{ item.quantity }}" min="1" class="w-16 px-2 py-1 border rounded">
                        <button type="submit" class="px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition">Update</button>
                    </form>
                    <form method="POST" action="{% url 'cart' %}">
                        {% csrf_token %}
                        <input type="hidden" name="delete" value="1">
                        <input type="hidden" name="product_id" value="{{ item.product.id }}">
                        <button type="submit" class="px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition">Delete</button>
                    </form>
                </div>
            </div>
        {% endfor %}
    </div>

    <div class="text-right mt-8">
        <p class="text-xl font-bold mb-2">Total: ₹{{ total_price }}</p>
        <a href="{% url 'order_create' %}" class="bg-green-600 text-white px-6 py-3 rounded hover:bg-green-700 transition">Proceed to Checkout</a>
    </div>

{% else %}
    <div class="text-center mt-16">
        <img src="https://cdn-icons-png.flaticon.com/512/2038/2038854.png" alt="Empty Cart" class="mx-auto w-32 h-32 mb-4">
        <p class="text-xl text-gray-500">Your cart is empty. Let’s add something awesome!</p>
        <a href="{% url 'catalog' %}" class="inline-block mt-4 px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">Browse Products</a>
    </div>
{% endif %}
{% endblock %}
